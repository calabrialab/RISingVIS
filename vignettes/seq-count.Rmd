---
title: "Sequence Count computation with RISingVIS"
author: 
  - name: Chiara Pavia
    affiliation: | 
     San Raffaele Telethon Institute for Gene Therapy - SR-Tiget, 
     Via Olgettina 60, 20132 Milano - Italia
    email: pavia.chiara@hsr.it, giuliapais1@gmail.com, calabria.andrea@hsr.it
output: 
  BiocStyle::html_document:
    self_contained: yes
    toc: true
    toc_float: true
    toc_depth: 2
    code_folding: show
date: "`r doc_date()`"
package: "`r pkg_ver('RISingVIS')`"
vignette: >
  %\VignetteIndexEntry{Sequence Count computation with RISingVIS}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

In this vignette we explain how to use the functions dedicated to the 
computation of the sequence count ratio. 

The **sequence count ratio** is computed as follows: 

$$
R = \frac{\sum{SeqCount[CEMs]}}{\sum{SeqCount[Samples]}}
$$

We assume that the SeqCount of integrations actually belonging to a sample is 
much higher with respect to the SeqCount resulting from the sharing 
of the integration itself. 

# Load data

First, create an appropriate matrix and association file or import the
ones that are included in the package data (these files are designed manually 
but simulate real research data).

```{r setup}
library(RISingVIS)

data("association_file")
data("integration_matrix")
```

Once we have our data we can start computing ratios. 

# shared_CEM_known_IS_ratio()

The function `shared_CEM_known_IS_ratio()` computes the ratio for all the 
shared CEM known integrations.

```{r}
shared_CEM_known_IS_ratio(association_file, integration_matrix)
```

# shared_other_IS_ratio()

The function `shared_other_IS_ratio()` computes the ratio for all the shared 
integrations not belonging to CEMs. 

```{r}
shared_other_IS_ratio(association_file, integration_matrix)
```

# shared_IS_ratio()

The function `shared_IS_ratio()` computes the ratio for all shared integrations 
considering one sample at a time for the denominator or all samples. 

```{r}
shared_IS_ratio(association_file, integration_matrix)
```

# shared_IS_ratio_byIS()

The function `shared_IS_ratio_byIS()` computes the ratio for all integrations
considering one IS at a time, against each sample and all samples together. 

```{r}
shared_IS_ratio_byIS(association_file, integration_matrix)
```

