# Sharing tests ----------------------------------------------------------------

expected_lu <- tibble::tibble(
    group_id = c(
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2"
    ),
    SubjectID = c(
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
        "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
        "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
        "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2"
    ),
    chr = c(
        "1", "1", "10", "10", "11", "11", "11", "14", "14", "15", "15",
        "15", "16", "17", "17", "17", "19", "2", "2", "2", "2", "2", "22",
        "3", "3", "3", "3", "4", "4", "4", "4", "5", "6", "6", "6", "7",
        "8", "8", "9", "X", "1", "1", "10", "10", "11", "11", "11", "11",
        "11", "12", "13", "13", "14", "14", "14", "15", "17", "17", "17",
        "17", "17", "18", "18", "19", "2", "2", "2", "2", "2", "2", "20",
        "21", "3", "3", "3", "4", "4", "4", "4", "4", "4", "5", "5", "5",
        "5", "5", "5", "5", "6", "6", "6", "6", "6", "7", "7", "7", "8",
        "8", "9", "9", "X", "Y", "1", "1", "1", "1", "1", "1", "1", "10",
        "10", "10", "10", "11", "11", "11", "11", "12", "12", "12", "12",
        "13", "14", "14", "14", "17", "17", "17", "17", "17", "19", "19",
        "2", "2", "2", "2", "21", "22", "3", "3", "3", "3", "3", "4", "4",
        "4", "5", "5", "6", "6", "6", "6", "7", "7", "7", "8", "9", "9",
        "9", "X"
    ),
    integration_locus = c(
        72316420, 107738833, 99769976, 122533874, 64536890,
        64537168, 99226738, 55632528, 69454301, 81997291,
        84612237, 99811361, 28497498, 2032352, 4239278,
        47732339, 18397227, 24546571, 26023003, 73762398,
        159801008, 165396956, 21362685, 74357318, 103488034,
        154702496, 194109490, 21702365, 37126074, 117829036,
        180216845, 150053083, 36095826, 56755845, 86233945,
        130004213, 8866486, 95470736, 21611199, 117111444,
        6914548, 104100386, 60971172, 70898381, 63610146,
        64537168, 67968180, 76232617, 103335790, 53807564,
        45978592, 46652294, 24852752, 34549688, 70994046,
        63507023, 2032352, 8364888, 57815078, 59663043,
        74731721, 8080729, 53228083, 49824117, 68534683,
        78338334, 100740771, 188272131, 213677449, 216203325,
        33791447, 38507116, 48620939, 115531179, 125058605,
        56876037, 63385391, 63385399, 89704079, 140308858,
        173228718, 7863185, 12909822, 61893034, 70810680,
        170576342, 176613642, 179978593, 36095826, 56755845,
        82903940, 102612728, 121616248, 9979029, 26376494,
        81432887, 41854278, 71035475, 73198999, 139603671,
        121871333, 9459057, 41210214, 46361792, 72316420,
        99128369, 144957147, 176059775, 206238042, 26749524,
        85333141, 121351765, 122533874, 17333340, 47407049,
        65415397, 94020384, 29364728, 60097776, 106416080,
        121239427, 85159673, 30481249, 50246648, 101454650,
        5207377, 29099759, 38316277, 73798160, 76693216,
        12716487, 42552596, 70318781, 75943873, 153871981,
        222254106, 17624117, 50950904, 27118714, 29887390,
        49126935, 81748974, 173514328, 22448480, 60703808,
        185637826, 74736626, 86665862, 24933009, 29436691,
        36026151, 36095826, 17364768, 128392260, 150216222,
        67483456, 3077796, 139788297, 139826750, 9672353
    ),
    strand = c(
        "-", "-", "-", "-", "-", "-", "-", "-", "+", "-", "-", "-", "-",
        "-", "+", "-", "-", "-", "+", "-", "+", "+", "-", "+", "-", "-",
        "+", "-", "+", "+", "-", "-", "-", "+", "+", "-", "+", "+", "-",
        "+", "+", "-", "+", "+", "+", "-", "-", "+", "+", "-", "-", "-",
        "-", "+", "+", "+", "-", "+", "-", "-", "-", "+", "-", "+", "+",
        "-", "+", "+", "-", "-", "-", "+", "-", "+", "+", "+", "-", "-",
        "+", "+", "+", "-", "+", "+", "+", "-", "-", "-", "-", "+", "-",
        "+", "+", "-", "-", "-", "+", "+", "-", "+", "+", "+", "-", "-",
        "-", "-", "+", "+", "+", "-", "+", "+", "-", "-", "-", "-", "-",
        "+", "+", "-", "-", "-", "-", "+", "+", "+", "-", "+", "+", "-",
        "-", "-", "+", "+", "+", "-", "+", "-", "-", "+", "-", "+", "+",
        "+", "+", "-", "+", "+", "+", "+", "-", "-", "+", "+", "+", "+",
        "-", "-", "+", "-"
    ),
    seq_count = c(
        1, 3, 1, 3, 1, 678184, 1, 1, 2, 3, 28, 1, 143466, 592780, 1,
        557216, 1, 513871, 1, 572747, 2, 1, 1, 4, 1, 1, 1, 1, 1, 1,
        17, 1, 4, 4, 1, 1, 73, 2, 21, 36, 7532, 507, 1, 1, 3300, 1,
        58, 336, 1136, 12136, 435, 1059, 4, 1, 1, 6944, 1, 4, 9937,
        1, 2198, 2, 3670, 3409, 1, 1, 493, 10, 3809, 639, 21, 3, 1,
        1, 4150, 453, 1, 1239, 369, 2, 12629, 2218, 739, 3152, 3649,
        5, 3431, 1227, 2, 3, 575, 1, 11446, 2, 1, 4709, 3817, 4812,
        1, 3551, 2712, 1, 2083, 175, 1, 1, 50, 1, 2, 62890, 1, 326,
        1, 11144, 1, 397, 9, 119, 25, 1, 5223, 6151, 4, 2135, 30887,
        8749, 4690, 1, 473, 3426, 2344, 165, 1813, 2503, 1, 10, 5776,
        613, 1, 5, 19732, 18, 97, 5404, 4, 411, 8925, 701, 114, 3364,
        12187, 1, 173, 10, 1490, 2881, 65727, 9, 8807, 1
    ),
    abs_rep_count = c(
        1, 2, 1, 2, 1, 3, 1, 1, 1, 1, 1, 1, 3, 3, 1, 3, 1, 3, 1, 3,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1,
        1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1
    ),
    raw_reads = c(
        4153739, 6093863, 4153739, 3908656, 4153739, 8062395, 4153739,
        1968532, 1940124, 1940124, 4153739, 1968532, 8062395, 8062395,
        4153739, 8062395, 1968532, 8062395, 4153739, 8062395, 1940124,
        1940124, 4153739, 1940124, 1968532, 1940124, 1968532, 1968532,
        1940124, 4153739, 1968532, 4153739, 6122271, 6093863, 1968532,
        1940124, 4153739, 1940124, 1968532, 1968532, 805127, 1048886,
        1121480, 805127, 805127, 1048886, 944062, 1926607, 1048886,
        944062, 1121480, 1121480, 798983, 798983, 1121480, 944062,
        1048886, 1048886, 944062, 1048886, 805127, 944062, 1121480,
        888470, 1048886, 944062, 888470, 888470, 1048886, 1121480,
        944062, 888470, 1048886, 888470, 805127, 1048886, 888470,
        1832532, 805127, 798983, 944062, 798983, 944062, 798983,
        1048886, 805127, 798983, 888470, 1121480, 1920463, 888470,
        1121480, 798983, 805127, 1121480, 798983, 805127, 798983,
        888470, 798983, 1048886, 1121480, 832245, 1164872, 964409,
        1029109, 832245, 832245, 964409, 1164872, 1122319, 1122319,
        832245, 1811654, 847245, 847245, 1122319, 1029109, 964409,
        1122319, 1122319, 2129281, 1122319, 1029109, 964409, 847245,
        964409, 832245, 2129281, 847245, 1164872, 1122319, 832245,
        1164872, 832245, 847245, 1164872, 1164872, 1164872, 1122319,
        847245, 1029109, 1029109, 964409, 1122319, 847245, 964409,
        1029109, 1029109, 1029109, 847245, 964409, 832245, 1029109,
        832245, 1164872, 832245, 964409, 2998673, 832245
    ),
    tot_rep = c(
        3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
        3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 6, 6,
        6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
        6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
        6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
        6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
        6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
        6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
    ),
    rep_count = c(
        0.333333333333333, 0.666666666666667, 0.333333333333333,
        0.666666666666667, 0.333333333333333, 1, 0.333333333333333,
        0.333333333333333, 0.333333333333333, 0.333333333333333,
        0.333333333333333, 0.333333333333333, 1, 1,
        0.333333333333333, 1, 0.333333333333333, 1,
        0.333333333333333, 1, 0.333333333333333,
        0.333333333333333, 0.333333333333333, 0.333333333333333,
        0.333333333333333, 0.333333333333333, 0.333333333333333,
        0.333333333333333, 0.333333333333333, 0.333333333333333,
        0.333333333333333, 0.333333333333333, 0.666666666666667,
        0.666666666666667, 0.333333333333333, 0.333333333333333,
        0.333333333333333, 0.333333333333333, 0.333333333333333,
        0.333333333333333, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.333333333333333,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.333333333333333,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.333333333333333,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.333333333333333,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.333333333333333, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.333333333333333,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.166666666666667,
        0.166666666666667, 0.166666666666667, 0.5, 0.166666666666667
    )
)

expected_labs_self <- tibble::tibble(
    labs = c(
        "CEM37_CEM37", "CEM37_SUB1", "CEM37_SUB2", "SUB1_SUB1",
        "SUB1_SUB2", "SUB2_SUB2"
    ),
    g1 = c("CEM37", "CEM37", "CEM37", "SUB1", "SUB1", "SUB2"),
    g2 = c("CEM37", "SUB1", "SUB2", "SUB1", "SUB2", "SUB2"),
    un = c(1, 2, 2, 1, 2, 1)
)
expected_labs_no_self <- tibble::tibble(
    labs = c("CEM37_SUB1", "CEM37_SUB2", "SUB1_SUB2"),
    g1 = c("CEM37", "CEM37", "SUB1"),
    g2 = c("SUB1", "SUB2", "SUB2"),
    un = c(2, 2, 2)
)

expected_common <- tibble::tibble(
    g1 = c("CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
           "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
           "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
           "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
           "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
           "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
           "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2"),
    g2 = c("CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
           "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
           "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
           "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
           "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
           "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB2", "SUB2", "SUB2", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
           "SUB1", "SUB1", "SUB1", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
           "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2"),
    shared = c(40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40,
               40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40,
               40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 4, 4, 4, 4, 3, 3, 3,
               62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
               62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
               62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
               62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
               62, 62, 1, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
               58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
               58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
               58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58),
    count_g1 = c(40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40,
                 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40,
                 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40,
                 40, 40, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                 62, 62, 62, 62, 62, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
                 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
                 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
                 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
                 58, 58, 58),
    count_g2 = c(40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40,
                 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40,
                 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 62, 62, 62, 62, 58,
                 58, 58, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                 62, 62, 62, 62, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
                 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
                 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
                 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
                 58, 58, 58),
    count_union = c(40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40,
                    40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40,
                    40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 98, 98,
                    98, 98, 95, 95, 95, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                    62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                    62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                    62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62,
                    62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 119, 58, 58,
                    58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
                    58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
                    58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58,
                    58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58),
    tot_rep_g1 = c(3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                   3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                   3, 3, 3, 3, 3, 3, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6),
    tot_rep_g2 = c(3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                   3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                   6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                   6, 6, 6, 6, 6, 6, 6, 6),
    SubjectID_g1 = c("CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2"),
    chr = c("1", "1", "10", "10", "11", "11", "11", "14", "14", "15", "15",
            "15", "16", "17", "17", "17", "19", "2", "2", "2", "2", "2", "22",
            "3", "3", "3", "3", "4", "4", "4", "4", "5", "6", "6", "6", "7",
            "8", "8", "9", "X", "11", "17", "6", "6", "1", "10", "6", "1", "1",
            "10", "10", "11", "11", "11", "11", "11", "12", "13", "13", "14",
            "14", "14", "15", "17", "17", "17", "17", "17", "18", "18", "19",
            "2", "2", "2", "2", "2", "2", "20", "21", "3", "3", "3", "4", "4",
            "4", "4", "4", "4", "5", "5", "5", "5", "5", "5", "5", "6", "6",
            "6", "6", "6", "7", "7", "7", "8", "8", "9", "9", "X", "Y", "6",
            "1", "1", "1", "1", "1", "1", "1", "10", "10", "10", "10", "11",
            "11", "11", "11", "12", "12", "12", "12", "13", "14", "14", "14",
            "17", "17", "17", "17", "17", "19", "19", "2", "2", "2", "2", "21",
            "22", "3", "3", "3", "3", "3", "4", "4", "4", "5", "5", "6", "6",
            "6", "6", "7", "7", "7", "8", "9", "9", "9", "X"),
    integration_locus = c(72316420, 107738833, 99769976, 122533874, 64536890,
                          64537168, 99226738, 55632528, 69454301, 81997291,
                          84612237, 99811361, 28497498, 2032352, 4239278,
                          47732339, 18397227, 24546571, 26023003, 73762398,
                          159801008, 165396956, 21362685, 74357318, 103488034,
                          154702496, 194109490, 21702365, 37126074, 117829036,
                          180216845, 150053083, 36095826, 56755845, 86233945,
                          130004213, 8866486, 95470736, 21611199, 117111444,
                          64537168, 2032352, 36095826, 56755845, 72316420,
                          122533874, 36095826, 6914548, 104100386, 60971172,
                          70898381, 63610146, 64537168, 67968180, 76232617,
                          103335790, 53807564, 45978592, 46652294, 24852752,
                          34549688, 70994046, 63507023, 2032352, 8364888,
                          57815078, 59663043, 74731721, 8080729, 53228083,
                          49824117, 68534683, 78338334, 100740771, 188272131,
                          213677449, 216203325, 33791447, 38507116, 48620939,
                          115531179, 125058605, 56876037, 63385391, 63385399,
                          89704079, 140308858, 173228718, 7863185, 12909822,
                          61893034, 70810680, 170576342, 176613642, 179978593,
                          36095826, 56755845, 82903940, 102612728, 121616248,
                          9979029, 26376494, 81432887, 41854278, 71035475,
                          73198999, 139603671, 121871333, 9459057, 36095826,
                          41210214, 46361792, 72316420, 99128369, 144957147,
                          176059775, 206238042, 26749524, 85333141, 121351765,
                          122533874, 17333340, 47407049, 65415397, 94020384,
                          29364728, 60097776, 106416080, 121239427, 85159673,
                          30481249, 50246648, 101454650, 5207377, 29099759,
                          38316277, 73798160, 76693216, 12716487, 42552596,
                          70318781, 75943873, 153871981, 222254106, 17624117,
                          50950904, 27118714, 29887390, 49126935, 81748974,
                          173514328, 22448480, 60703808, 185637826, 74736626,
                          86665862, 24933009, 29436691, 36026151, 36095826,
                          17364768, 128392260, 150216222, 67483456, 3077796,
                          139788297, 139826750, 9672353),
    strand = c("-", "-", "-", "-", "-", "-", "-", "-", "+", "-", "-", "-", "-",
               "-", "+", "-", "-", "-", "+", "-", "+", "+", "-", "+", "-", "-",
               "+", "-", "+", "+", "-", "-", "-", "+", "+", "-", "+", "+", "-",
               "+", "-", "-", "-", "+", "-", "-", "-", "+", "-", "+", "+", "+",
               "-", "-", "+", "+", "-", "-", "-", "-", "+", "+", "+", "-", "+",
               "-", "-", "-", "+", "-", "+", "+", "-", "+", "+", "-", "-", "-",
               "+", "-", "+", "+", "+", "-", "-", "+", "+", "+", "-", "+", "+",
               "+", "-", "-", "-", "-", "+", "-", "+", "+", "-", "-", "-", "+",
               "+", "-", "+", "+", "+", "-", "-", "-", "-", "-", "+", "+", "+",
               "-", "+", "+", "-", "-", "-", "-", "-", "+", "+", "-", "-", "-",
               "-", "+", "+", "+", "-", "+", "+", "-", "-", "-", "+", "+", "+",
               "-", "+", "-", "-", "+", "-", "+", "+", "+", "+", "-", "+", "+",
               "+", "+", "-", "-", "+", "+", "+", "+", "-", "-", "+", "-"),
    seq_count_g1 = c(1, 3, 1, 3, 1, 678184, 1, 1, 2, 3, 28, 1, 143466, 592780,
                     1, 557216, 1, 513871, 1, 572747, 2, 1, 1, 4, 1, 1, 1, 1,
                     1, 1, 17, 1, 4, 4, 1, 1, 73, 2, 21, 36, 678184, 592780, 4,
                     4, 1, 3, 4, 7532, 507, 1, 1, 3300, 1, 58, 336, 1136,
                     12136, 435, 1059, 4, 1, 1, 6944, 1, 4, 9937, 1, 2198, 2,
                     3670, 3409, 1, 1, 493, 10, 3809, 639, 21, 3, 1, 1, 4150,
                     453, 1, 1239, 369, 2, 12629, 2218, 739, 3152, 3649, 5,
                     3431, 1227, 2, 3, 575, 1, 11446, 2, 1, 4709, 3817, 4812,
                     1, 3551, 2712, 1, 2, 2083, 175, 1, 1, 50, 1, 2, 62890, 1,
                     326, 1, 11144, 1, 397, 9, 119, 25, 1, 5223, 6151, 4, 2135,
                     30887, 8749, 4690, 1, 473, 3426, 2344, 165, 1813, 2503, 1,
                     10, 5776, 613, 1, 5, 19732, 18, 97, 5404, 4, 411, 8925,
                     701, 114, 3364, 12187, 1, 173, 10, 1490, 2881, 65727, 9,
                     8807, 1),
    abs_rep_count_g1 = c(1, 2, 1, 2, 1, 3, 1, 1, 1, 1, 1, 1, 3, 3, 1, 3, 1, 3,
                         1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1,
                         1, 1, 1, 1, 3, 3, 2, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1,
                         2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1,
                         1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 3, 1),
    raw_reads_g1 = c(4153739, 6093863, 4153739, 3908656, 4153739, 8062395,
                     4153739, 1968532, 1940124, 1940124, 4153739, 1968532,
                     8062395, 8062395, 4153739, 8062395, 1968532, 8062395,
                     4153739, 8062395, 1940124, 1940124, 4153739, 1940124,
                     1968532, 1940124, 1968532, 1968532, 1940124, 4153739,
                     1968532, 4153739, 6122271, 6093863, 1968532, 1940124,
                     4153739, 1940124, 1968532, 1968532, 8062395, 8062395,
                     6122271, 6093863, 4153739, 3908656, 6122271, 805127,
                     1048886, 1121480, 805127, 805127, 1048886, 944062,
                     1926607, 1048886, 944062, 1121480, 1121480, 798983,
                     798983, 1121480, 944062, 1048886, 1048886, 944062,
                     1048886, 805127, 944062, 1121480, 888470, 1048886,
                     944062, 888470, 888470, 1048886, 1121480, 944062, 888470,
                     1048886, 888470, 805127, 1048886, 888470, 1832532, 805127,
                     798983, 944062, 798983, 944062, 798983, 1048886, 805127,
                     798983, 888470, 1121480, 1920463, 888470, 1121480, 798983,
                     805127, 1121480, 798983, 805127, 798983, 888470, 798983,
                     1048886, 1121480, 1121480, 832245, 1164872, 964409,
                     1029109, 832245, 832245, 964409, 1164872, 1122319,
                     1122319, 832245, 1811654, 847245, 847245, 1122319,
                     1029109, 964409, 1122319, 1122319, 2129281, 1122319,
                     1029109, 964409, 847245, 964409, 832245, 2129281,
                     847245, 1164872, 1122319, 832245, 1164872, 832245,
                     847245, 1164872, 1164872, 1164872, 1122319, 847245,
                     1029109, 1029109, 964409, 1122319, 847245, 964409,
                     1029109, 1029109, 1029109, 847245, 964409, 832245,
                     1029109, 832245, 1164872, 832245, 964409, 2998673, 832245),
    rep_count_g1 = c(0.333333333333333, 0.666666666666667, 0.333333333333333,
                     0.666666666666667, 0.333333333333333, 1, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 1, 1,
                     0.333333333333333, 1, 0.333333333333333, 1,
                     0.333333333333333, 1, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 0.666666666666667,
                     0.666666666666667, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 1, 1, 0.666666666666667,
                     0.666666666666667, 0.333333333333333, 0.666666666666667,
                     0.666666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.333333333333333,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.333333333333333,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.333333333333333,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.333333333333333, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.333333333333333,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.333333333333333, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.5, 0.166666666666667),
    SubjectID_g2 = c("CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "CEM37", "CEM37",
                     "CEM37", "CEM37", "CEM37", "CEM37", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB2", "SUB2", "SUB2", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1", "SUB1",
                     "SUB1", "SUB1", "SUB1", "SUB1", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2",
                     "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2", "SUB2"),
    seq_count_g2 = c(1, 3, 1, 3, 1, 678184, 1, 1, 2, 3, 28, 1, 143466, 592780,
                     1, 557216, 1, 513871, 1, 572747, 2, 1, 1, 4, 1, 1, 1, 1,
                     1, 1, 17, 1, 4, 4, 1, 1, 73, 2, 21, 36, 1, 1, 2, 3, 1, 1,
                     1, 7532, 507, 1, 1, 3300, 1, 58, 336, 1136, 12136, 435,
                     1059, 4, 1, 1, 6944, 1, 4, 9937, 1, 2198, 2, 3670, 3409,
                     1, 1, 493, 10, 3809, 639, 21, 3, 1, 1, 4150, 453, 1, 1239,
                     369, 2, 12629, 2218, 739, 3152, 3649, 5, 3431, 1227, 2, 3,
                     575, 1, 11446, 2, 1, 4709, 3817, 4812, 1, 3551, 2712, 1, 1,
                     2083, 175, 1, 1, 50, 1, 2, 62890, 1, 326, 1, 11144, 1, 397,
                     9, 119, 25, 1, 5223, 6151, 4, 2135, 30887, 8749, 4690, 1,
                     473, 3426, 2344, 165, 1813, 2503, 1, 10, 5776, 613, 1, 5,
                     19732, 18, 97, 5404, 4, 411, 8925, 701, 114, 3364, 12187,
                     1, 173, 10, 1490, 2881, 65727, 9, 8807, 1),
    abs_rep_count_g2 = c(1, 2, 1, 2, 1, 3, 1, 1, 1, 1, 1, 1, 3, 3, 1, 3, 1, 3,
                         1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1,
                         1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 3, 1),
    raw_reads_g2 = c(4153739, 6093863, 4153739, 3908656, 4153739, 8062395,
                     4153739, 1968532, 1940124, 1940124, 4153739, 1968532,
                     8062395, 8062395, 4153739, 8062395, 1968532, 8062395,
                     4153739, 8062395, 1940124, 1940124, 4153739, 1940124,
                     1968532, 1940124, 1968532, 1968532, 1940124, 4153739,
                     1968532, 4153739, 6122271, 6093863, 1968532, 1940124,
                     4153739, 1940124, 1968532, 1968532, 1048886, 1048886,
                     1121480, 1920463, 964409, 832245, 964409, 805127, 1048886,
                     1121480, 805127, 805127, 1048886, 944062, 1926607, 1048886,
                     944062, 1121480, 1121480, 798983, 798983, 1121480, 944062,
                     1048886, 1048886, 944062, 1048886, 805127, 944062, 1121480,
                     888470, 1048886, 944062, 888470, 888470, 1048886, 1121480,
                     944062, 888470, 1048886, 888470, 805127, 1048886, 888470,
                     1832532, 805127, 798983, 944062, 798983, 944062, 798983,
                     1048886, 805127, 798983, 888470, 1121480, 1920463, 888470,
                     1121480, 798983, 805127, 1121480, 798983, 805127, 798983,
                     888470, 798983, 1048886, 1121480, 964409, 832245, 1164872,
                     964409, 1029109, 832245, 832245, 964409, 1164872, 1122319,
                     1122319, 832245, 1811654, 847245, 847245, 1122319, 1029109,
                     964409, 1122319, 1122319, 2129281, 1122319, 1029109,
                     964409, 847245, 964409, 832245, 2129281, 847245, 1164872,
                     1122319, 832245, 1164872, 832245, 847245, 1164872, 1164872,
                     1164872, 1122319, 847245, 1029109, 1029109, 964409,
                     1122319, 847245, 964409, 1029109, 1029109, 1029109,
                     847245, 964409, 832245, 1029109, 832245, 1164872, 832245,
                     964409, 2998673, 832245),
    rep_count_g2 = c(0.333333333333333, 0.666666666666667, 0.333333333333333,
                     0.666666666666667, 0.333333333333333, 1, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 1, 1,
                     0.333333333333333, 1, 0.333333333333333, 1,
                     0.333333333333333, 1, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 0.666666666666667, 0.666666666666667,
                     0.333333333333333, 0.333333333333333, 0.333333333333333,
                     0.333333333333333, 0.333333333333333, 0.333333333333333,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.333333333333333, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.333333333333333,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.333333333333333,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.333333333333333,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.333333333333333, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.333333333333333,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.333333333333333, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.166666666666667, 0.166666666666667, 0.166666666666667,
                     0.5, 0.166666666666667)
) |> tidyr::nest(
    is_details = c(
        "SubjectID_g1", "chr", "integration_locus", "strand",
        "seq_count_g1", "abs_rep_count_g1", "raw_reads_g1",
        "rep_count_g1",
        "SubjectID_g2", "seq_count_g2", "abs_rep_count_g2",
        "raw_reads_g2", "rep_count_g2"
    )
)

# .verify_df_keys ----
test_that(".verify_df_keys errors for incorrect keys", {
    # Single df, single key errors
    input_dfs <- list(data_and_meta)
    key <- c(1, 2, 3) # Not char
    expect_error(
        .verify_df_keys(input_dfs, key),
        class = "key_format_error"
    )
    key <- c("A", "CompleteAmplificationID") # Not present in cols
    expect_error(
        .verify_df_keys(input_dfs, key),
        class = "key_not_found_error"
    )
    # Mult df, single key
    input_dfs <- list(data_and_meta, data_and_meta)
    key <- c(1, 2, 3) # Not char
    expect_error(
        .verify_df_keys(input_dfs, key),
        class = "key_format_error"
    )
    key <- c("A", "CompleteAmplificationID") # Not present in cols
    expect_error(
        .verify_df_keys(input_dfs, key),
        class = "key_not_found_error"
    )
    # Single df, multi key
    input_dfs <- list(data_and_meta)
    key <- list(c(1, 2, 3))
    expect_error(
        .verify_df_keys(input_dfs, key),
        class = "key_format_error"
    )
    key <- list(c("A", "C"), c("A", "B"), c("D", "E"))
    expect_error(
        .verify_df_keys(input_dfs, key),
        class = "key_length_error"
    )
    key <- list(c("A", "C"))
    expect_error(
        .verify_df_keys(input_dfs, key),
        class = "key_not_found_error"
    )
    # Multi df, multi key
    input_dfs <- list(data_and_meta, data_and_meta)
    key <- list(c(1, 2, 3), c("A", "B"))
    expect_error(
        .verify_df_keys(input_dfs, key),
        class = "key_format_error"
    )
    key <- list(c("A", "C"), c("A", "B"))
    expect_error(
        .verify_df_keys(input_dfs, key),
        class = "key_not_found_error"
    )
    key <- list(c("A", "C"), c("A", "B"), c("D", "E"))
    expect_error(
        .verify_df_keys(input_dfs, key),
        class = "key_length_error"
    )
})

test_that(".verify_df_keys errors for incorrect inputs", {
    input_dfs <- list(1, data_and_meta)
    expect_error(
        .verify_df_keys(input_dfs, "CompleteAmplificationID"),
        class = "inputs_not_df_error"
    )
})

# .obtain_lookup_tbl ----
test_that(".obtain_lookup_tbl produces expected", {
    single_pool <- data_and_meta |>
        dplyr::filter(
            .data$PoolID == "POOL1"
        )
    lu <- .obtain_lookup_tbl(single_pool,
        key = "SubjectID",
        seqCount_col = "seqCount",
        replicate_col = "CompleteAmplificationID",
        barcode_mux_col = "BARCODE_MUX"
    )
    expect_equal(
        lu |> dplyr::arrange(
            .data$group_id,
            .data$chr, .data$integration_locus,
            .data$strand
        ),
        expected_lu |> dplyr::arrange(
            .data$group_id,
            .data$chr,
            .data$integration_locus,
            .data$strand
        )
    )
})

# .get_label_combinations ----
test_that(".get_label_combinations produces expected output", {
    labs_self <- .get_label_combinations(list(expected_lu),
        self_comb = TRUE
    )
    labs_no_self <- .get_label_combinations(list(expected_lu),
        self_comb = FALSE
    )
    expect_equal(
        labs_self |> dplyr::arrange(.data$labs),
        expected_labs_self |> dplyr::arrange(.data$labs)
    )
    expect_equal(
        labs_no_self |> dplyr::arrange(.data$labs),
        expected_labs_no_self |> dplyr::arrange(.data$labs)
    )
})

# .find_in_common ----
test_that(".find_in_common produces expected results", {
    out <- purrr::pmap_df(expected_labs_self, .find_in_common,
        lookups = list(expected_lu, expected_lu)
    )
    expect_equal(
        out,
        expected_common
    )
})

# .sh_row_permut ----
test_that(".sh_row_permut correctly expands row", {
    row_in <- expected_common[2, ]
    rows_out <- purrr::pmap_df(row_in, .sh_row_permut, g_names = c("g1", "g2"))

    expected_rows_out <- tibble::tibble(
      g1 = c('CEM37', 'CEM37', 'CEM37', 'CEM37', 'SUB1', 'SUB1', 'SUB1',
             'SUB1'),
      g2 = c('SUB1', 'SUB1', 'SUB1', 'SUB1', 'CEM37', 'CEM37', 'CEM37',
             'CEM37'),
      shared = c(4, 4, 4, 4, 4, 4, 4, 4),
      count_g1 = c(40, 40, 40, 40, 62, 62, 62, 62),
      count_g2 = c(62, 62, 62, 62, 40, 40, 40, 40),
      count_union = c(98, 98, 98, 98, 98, 98, 98, 98),
      tot_rep_g1 = c(3, 3, 3, 3, 6, 6, 6, 6),
      tot_rep_g2 = c(6, 6, 6, 6, 3, 3, 3, 3),
      SubjectID_g1 = c('CEM37', 'CEM37', 'CEM37', 'CEM37', 'SUB1', 'SUB1',
                       'SUB1', 'SUB1'),
      chr = c('11', '17', '6', '6', '11', '17', '6', '6'),
      integration_locus = c(64537168, 2032352, 36095826, 56755845, 64537168,
                            2032352, 36095826, 56755845),
      strand = c('-', '-', '-', '+', '-', '-', '-', '+'),
      seq_count_g1 = c(678184, 592780, 4, 4, 1, 1, 2, 3),
      abs_rep_count_g1 = c(3, 3, 2, 2, 1, 1, 1, 2),
      raw_reads_g1 = c(8062395, 8062395, 6122271, 6093863, 1048886, 1048886,
                       1121480, 1920463),
      rep_count_g1 = c(1, 1, 0.666666666666667, 0.666666666666667,
                       0.166666666666667, 0.166666666666667, 0.166666666666667,
                       0.333333333333333),
      SubjectID_g2 = c('SUB1', 'SUB1', 'SUB1', 'SUB1', 'CEM37', 'CEM37',
                       'CEM37', 'CEM37'),
      seq_count_g2 = c(1, 1, 2, 3, 678184, 592780, 4, 4),
      abs_rep_count_g2 = c(1, 1, 1, 2, 3, 3, 2, 2),
      raw_reads_g2 = c(1048886, 1048886, 1121480, 1920463, 8062395, 8062395,
                       6122271, 6093863),
      rep_count_g2 = c(0.166666666666667, 0.166666666666667, 0.166666666666667,
                       0.333333333333333, 1, 1, 0.666666666666667,
                       0.666666666666667)) |>
        tidyr::nest(is_details = !c(
            "g1", "g2", "shared", "count_g1",
            "count_g2", "count_union", "tot_rep_g1",
            "tot_rep_g2"
        ))

    expect_equal(rows_out, expected_rows_out)
})

# # ## .separate_known_unkown ----
# # test_that(".separate_known_unkown separates correctly", {
# #   result <- .separate_known_unkown(ex_ds_1,
# #                                    control_lines = list(
# #                                      CEM37 = default_cell_lines()$CEM37,
# #                                      Control2 = Control2
# #                                    ),
# #                                    subject_col = "SubjectID",
# #                                    blocking = TRUE)
# #   expect_true(is.list(result) & all(names(result) == c("result", "error")))
# #   expect_false(result$error)
# #   expect_equal(result$result$unknown, expected_unknown)
# #   expect_equal(result$result$samples, expected_samples)
# #   expect_equal(result$result$controls, expected_controls)
# # })
